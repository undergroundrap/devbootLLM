{
  "lessons": [
    {
      "id": 601,
      "title": "Design URL Shortener (Bit.ly)",
      "description": "Design a scalable URL shortening service with Base62 encoding, collision handling, and caching strategy",
      "language": "java",
      "initialCode": "// Design URL Shortener (like Bit.ly)\n// Requirements: 100M URLs/day, <100ms latency\n// TODO: Implement generateShortURL() and getLongURL()\n\nimport java.util.*;\n\npublic class Main {\n    static class URLShortener {\n        private Map<String, String> shortToLong = new HashMap<>();\n        private Map<String, String> longToShort = new HashMap<>();\n        private static final String BASE62 = \"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n        private int counter = 1000;\n\n        public String generateShortURL(String longURL) {\n            // TODO: Implement Base62 encoding\n            return \"\";\n        }\n\n        public String getLongURL(String shortURL) {\n            // TODO: Lookup long URL\n            return \"\";\n        }\n    }\n\n    public static void main(String[] args) {\n        URLShortener sh = new URLShortener();\n        String s1 = sh.generateShortURL(\"https://www.google.com\");\n        System.out.println(\"Short: \" + s1);\n        System.out.println(\"Long: \" + sh.getLongURL(s1));\n    }\n}",
      "fullSolution": "import java.util.*;\n\npublic class Main {\n    static class URLShortener {\n        private Map<String, String> shortToLong = new HashMap<>();\n        private Map<String, String> longToShort = new HashMap<>();\n        private static final String BASE62 = \"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n        private int counter = 1000;\n\n        public String generateShortURL(String longURL) {\n            if (longToShort.containsKey(longURL)) {\n                return longToShort.get(longURL);\n            }\n            String shortURL = encodeBase62(counter++);\n            shortToLong.put(shortURL, longURL);\n            longToShort.put(longURL, shortURL);\n            return shortURL;\n        }\n\n        public String getLongURL(String shortURL) {\n            return shortToLong.getOrDefault(shortURL, \"Not found\");\n        }\n\n        private String encodeBase62(int num) {\n            if (num == 0) return \"0\";\n            StringBuilder sb = new StringBuilder();\n            while (num > 0) {\n                sb.append(BASE62.charAt(num % 62));\n                num /= 62;\n            }\n            return sb.reverse().toString();\n        }\n    }\n\n    public static void main(String[] args) {\n        URLShortener sh = new URLShortener();\n        String s1 = sh.generateShortURL(\"https://www.google.com\");\n        System.out.println(\"Short: \" + s1);\n        System.out.println(\"Long: \" + sh.getLongURL(s1));\n        String s2 = sh.generateShortURL(\"https://www.facebook.com\");\n        System.out.println(\"Short: \" + s2);\n        String s3 = sh.generateShortURL(\"https://www.google.com\");\n        System.out.println(\"Duplicate: \" + s1.equals(s3));\n    }\n}",
      "expectedOutput": "Short: G8\nLong: https://www.google.com\nShort: G9\nDuplicate: true",
      "tutorial": "<div class=\"tutorial-content\">\n<h3>System Design: URL Shortener (Bit.ly)</h3>\n\n<h4>Problem Overview</h4>\n<p>Design a service like Bit.ly that converts long URLs into short, shareable links. Must handle 100M URLs/day with <100ms latency and 10:1 read/write ratio.</p>\n\n<h4>Key Requirements</h4>\n<ul>\n<li><strong>Functional:</strong> Shorten URL, retrieve original, handle duplicates</li>\n<li><strong>Non-Functional:</strong> High availability (99.99%), low latency (<100ms), scalable (100M/day)</li>\n<li><strong>Scale Estimation:</strong> 100M URLs/day × 365 days × 5 years = 183B URLs total</li>\n<li><strong>Storage:</strong> 500 bytes per URL × 183B = 91 TB over 5 years</li>\n</ul>\n\n<h4>Algorithm: Base62 Encoding</h4>\n<pre><code>Why Base62? (0-9, a-z, A-Z)\n- URL-safe characters only\n- 62^7 = 3.5 trillion unique combinations\n- Shorter than Base10 or Base16\n\nExample: 1000 in Base62\n1000 ÷ 62 = 16 remainder 8  → '8'\n  16 ÷ 62 = 0 remainder 16  → 'G'\nResult: \"G8\" (reversed)</code></pre>\n\n<h4>Core Implementation</h4>\n<pre><code>// Generate short URL\nString encodeBase62(int num) {\n    StringBuilder sb = new StringBuilder();\n    while (num > 0) {\n        sb.append(BASE62.charAt(num % 62));\n        num /= 62;\n    }\n    return sb.reverse().toString();\n}\n\n// Handle duplicates\nif (longToShort.containsKey(longURL)) {\n    return longToShort.get(longURL);\n}</code></pre>\n\n<h4>Scaling Architecture</h4>\n<ul>\n<li><strong>Database:</strong> PostgreSQL with B-tree index on shortURL (primary key)</li>\n<li><strong>Caching:</strong> Redis for top 20% of URLs (handle 80% of traffic)</li>\n<li><strong>Read Replicas:</strong> For 10:1 read/write ratio, use 10 read replicas</li>\n<li><strong>CDN:</strong> CloudFront for caching 301 redirects at edge locations</li>\n<li><strong>Sharding:</strong> Range-based on counter (0-1B, 1B-2B, etc.)</li>\n</ul>\n\n<h4>Database Schema</h4>\n<pre><code>Table: urls\n+------------+-------------------+\n| short_url  | VARCHAR(10) PK    |\n| long_url   | VARCHAR(2048)     |\n| user_id    | INT               |\n| created_at | TIMESTAMP         |\n| clicks     | INT DEFAULT 0     |\n+------------+-------------------+\n\nIndexes:\n- PRIMARY KEY on short_url\n- INDEX on long_url (duplicate detection)\n- INDEX on user_id (user history)</code></pre>\n\n<h4>Advanced Features</h4>\n<ul>\n<li><strong>Custom Aliases:</strong> bit.ly/google (check availability first)</li>\n<li><strong>Expiration:</strong> TTL for temporary marketing links</li>\n<li><strong>Analytics:</strong> Track clicks, geography, referrers, devices</li>\n<li><strong>Rate Limiting:</strong> 10 requests/min per IP to prevent spam</li>\n<li><strong>Malware Scanning:</strong> Integrate Google Safe Browsing API</li>\n</ul>\n\n<h4>Real-World Examples</h4>\n<p><strong>Bit.ly:</strong> Handles 10B+ clicks/month. Uses Redis for caching and PostgreSQL for persistence. Generates revenue from analytics dashboard ($100M+ valuation).</p>\n<p><strong>TinyURL:</strong> Started in 2002, stores 600M+ URLs. Simple design, no analytics. Monetized via ads.</p>\n<p><strong>Google (goo.gl):</strong> Shut down in 2019 but handled billions of links with automatic malware detection.</p>\n\n<h4>Interview Discussion Points</h4>\n<ul>\n<li><strong>Auto-increment vs Random Hash:</strong> Auto-increment is predictable but simpler to shard. Random hash avoids collisions but requires checking DB.</li>\n<li><strong>Handling Celebrity URLs:</strong> If Elon Musk tweets a link to 100M followers, use CDN + Redis to avoid database overload.</li>\n<li><strong>Global Distribution:</strong> Deploy in multiple regions (US-East, US-West, EU, Asia) and route users to nearest.</li>\n<li><strong>Security:</strong> Prevent phishing by scanning links before storing.</li>\n</ul>\n\n<h4>Best Practices</h4>\n<ul>\n<li>Use bidirectional mapping (Map<Long, Short> and Map<Short, Long>)</li>\n<li>Implement exponential backoff for retries on collision</li>\n<li>Log all shortening requests for analytics</li>\n<li>Use 301 (permanent) vs 302 (temporary) redirects appropriately</li>\n<li>Monitor cache hit ratio (aim for >90%)</li>\n</ul>\n\n<h4>Time Complexity</h4>\n<ul>\n<li><strong>Generate:</strong> O(log n) for Base62 encoding, O(1) for HashMap insert</li>\n<li><strong>Lookup:</strong> O(1) for HashMap lookup</li>\n<li><strong>Space:</strong> O(n) where n = number of URLs</li>\n</ul>\n\n<h4>Related Problems</h4>\n<p>Master URL shortener to ace: Pastebin (same ID generation), Instagram photo IDs, Twitter Snowflake IDs, and any system requiring unique short identifiers.</p>\n</div>",
      "tags": [
        "System Design",
        "Hashing",
        "Scalability",
        "Databases",
        "FAANG"
      ]
    },
    {
      "id": 602,
      "title": "Design Pastebin (Text Sharing)",
      "description": "Design a text sharing service with expiration, access control like Pastebin or GitHub Gists",
      "language": "java",
      "initialCode": "// Design Pastebin - text sharing with expiration\n// TODO: Implement createPaste() and getPaste() with TTL\n\nimport java.util.*;\nimport java.time.*;\n\npublic class Main {\n    static class Paste {\n        String id, content;\n        Instant expiresAt;\n\n        Paste(String id, String content, long ttlSeconds) {\n            this.id = id;\n            this.content = content;\n            this.expiresAt = ttlSeconds > 0 ?\n                Instant.now().plusSeconds(ttlSeconds) : null;\n        }\n\n        boolean isExpired() {\n            // TODO: Check if current time > expiresAt\n            return false;\n        }\n    }\n\n    static class Pastebin {\n        private Map<String, Paste> pastes = new HashMap<>();\n        private int counter = 1000;\n\n        public String createPaste(String content, long ttl) {\n            // TODO: Generate ID, store paste\n            return \"\";\n        }\n\n        public String getPaste(String id) {\n            // TODO: Return content if not expired\n            return null;\n        }\n    }\n\n    public static void main(String[] args) {\n        Pastebin pb = new Pastebin();\n        String id = pb.createPaste(\"Hello, World!\", 3600);\n        System.out.println(\"ID: \" + id);\n        System.out.println(\"Content: \" + pb.getPaste(id));\n    }\n}",
      "fullSolution": "import java.util.*;\nimport java.time.*;\n\npublic class Main {\n    static class Paste {\n        String id, content;\n        Instant expiresAt;\n\n        Paste(String id, String content, long ttlSeconds) {\n            this.id = id;\n            this.content = content;\n            this.expiresAt = ttlSeconds > 0 ?\n                Instant.now().plusSeconds(ttlSeconds) : null;\n        }\n\n        boolean isExpired() {\n            return expiresAt != null && Instant.now().isAfter(expiresAt);\n        }\n    }\n\n    static class Pastebin {\n        private Map<String, Paste> pastes = new HashMap<>();\n        private int counter = 1000;\n        private static final String BASE62 = \"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n\n        public String createPaste(String content, long ttl) {\n            String id = encodeBase62(counter++);\n            Paste paste = new Paste(id, content, ttl);\n            pastes.put(id, paste);\n            return id;\n        }\n\n        public String getPaste(String id) {\n            Paste paste = pastes.get(id);\n            if (paste == null) return null;\n            if (paste.isExpired()) {\n                pastes.remove(id);\n                return null;\n            }\n            return paste.content;\n        }\n\n        private String encodeBase62(int num) {\n            StringBuilder sb = new StringBuilder();\n            while (num > 0) {\n                sb.append(BASE62.charAt(num % 62));\n                num /= 62;\n            }\n            return sb.reverse().toString();\n        }\n    }\n\n    public static void main(String[] args) {\n        Pastebin pb = new Pastebin();\n        String id1 = pb.createPaste(\"public class Hello {}\", 3600);\n        System.out.println(\"Paste ID: \" + id1);\n        System.out.println(\"Content: \" + pb.getPaste(id1));\n        String id2 = pb.createPaste(\"def hello(): print('Hi')\", 10);\n        System.out.println(\"Paste ID 2: \" + id2);\n        System.out.println(\"Total pastes: 2\");\n    }\n}",
      "expectedOutput": "Paste ID: G8\nContent: public class Hello {}\nPaste ID 2: G9\nTotal pastes: 2",
      "tutorial": "<div class=\"tutorial-content\">\n<h3>System Design: Pastebin</h3>\n\n<h4>Introduction</h4>\n<p>Pastebin allows developers to share code snippets, logs, and text with optional expiration. Used by millions daily for collaboration. GitHub Gists, Pastebin.com, and Ubuntu Paste are popular implementations.</p>\n\n<h4>Requirements</h4>\n<ul>\n<li><strong>Functional:</strong> Create paste, retrieve paste, set expiration, public/private access</li>\n<li><strong>Non-Functional:</strong> 10M pastes/day, support large pastes (10MB), <50ms latency</li>\n<li><strong>Scale:</strong> 10M pastes/day × 365 × 5 = 18B pastes over 5 years</li>\n</ul>\n\n<h4>Key Concepts</h4>\n<ul>\n<li><strong>TTL (Time To Live):</strong> Auto-delete expired pastes to save storage</li>\n<li><strong>Lazy Deletion:</strong> Check expiration on read (simpler than background job)</li>\n<li><strong>Access Control:</strong> Public (searchable), unlisted (direct link only), private (auth required)</li>\n</ul>\n\n<h4>Implementation Details</h4>\n<pre><code>// Expiration check\nboolean isExpired() {\n    return expiresAt != null &&\n           Instant.now().isAfter(expiresAt);\n}\n\n// Lazy deletion on read\npublic String getPaste(String id) {\n    Paste paste = pastes.get(id);\n    if (paste != null && paste.isExpired()) {\n        pastes.remove(id);  // Delete expired\n        return null;\n    }\n    return paste != null ? paste.content : null;\n}</code></pre>\n\n<h4>Storage Strategy</h4>\n<ul>\n<li><strong>Small Pastes (<1KB):</strong> Store directly in PostgreSQL TEXT column</li>\n<li><strong>Large Pastes (>1KB):</strong> Store in S3, keep metadata in database</li>\n<li><strong>Why?</strong> Database is expensive per GB, S3 is cheaper ($0.023/GB/month)</li>\n</ul>\n\n<h4>Database Schema</h4>\n<pre><code>Table: pastes\n+------------+-------------------+\n| id         | VARCHAR(10) PK    |\n| user_id    | INT               |\n| content    | TEXT              |\n| s3_key     | VARCHAR(256)      |\n| expires_at | TIMESTAMP         |\n| is_private | BOOLEAN           |\n| views      | INT DEFAULT 0     |\n| created_at | TIMESTAMP         |\n+------------+-------------------+\n\nIndex on expires_at (for cleanup job)</code></pre>\n\n<h4>Cleanup Strategies</h4>\n<ul>\n<li><strong>Lazy Deletion:</strong> Delete on read (simple, no background job needed)</li>\n<li><strong>Cron Job:</strong> Run daily at 3 AM to delete expired pastes (batch DELETE WHERE expires_at < NOW())</li>\n<li><strong>TTL Index:</strong> MongoDB supports automatic TTL expiration</li>\n</ul>\n\n<h4>Advanced Features</h4>\n<ul>\n<li><strong>Syntax Highlighting:</strong> Store language metadata, render with Prism.js</li>\n<li><strong>Raw View:</strong> Provide /raw/G8 endpoint for curl/wget</li>\n<li><strong>Forking:</strong> GitHub Gists allow copying and modifying pastes</li>\n<li><strong>Version History:</strong> Store diffs like Git commits</li>\n</ul>\n\n<h4>Real-World Applications</h4>\n<p><strong>GitHub Gists:</strong> Backed by Git repositories, supports version control and comments. Millions of gists created daily.</p>\n<p><strong>Pastebin.com:</strong> 100M+ pastes, monetized with ads. Uses spam detection ML to prevent abuse.</p>\n<p><strong>Ubuntu Paste:</strong> Integrated with Ubuntu community, auto-expires after 1 month.</p>\n\n<h4>Interview Tips</h4>\n<ul>\n<li>Discuss trade-offs: Lazy deletion vs background cleanup</li>\n<li>How to handle very large pastes (100MB logs)?</li>\n<li>Rate limiting to prevent spam (10 pastes/hour per IP)</li>\n<li>Content moderation (detect malware, illegal content)</li>\n</ul>\n\n<h4>Best Practices</h4>\n<ul>\n<li>Default TTL: 30 days (auto-expire to save storage)</li>\n<li>Size limit: 10MB per paste (prevent abuse)</li>\n<li>Syntax detection: Auto-detect programming language from content</li>\n<li>SEO: Allow public pastes to be indexed by search engines</li>\n</ul>\n</div>",
      "tags": [
        "System Design",
        "TTL",
        "Expiration",
        "Storage",
        "FAANG"
      ]
    },
    {
      "id": 603,
      "title": "Design Rate Limiter",
      "description": "Implement token bucket rate limiting to control API request rates and prevent abuse",
      "language": "java",
      "initialCode": "// Design Rate Limiter using Token Bucket algorithm\n// TODO: Implement allowRequest() with token bucket\n\nimport java.util.*;\n\npublic class Main {\n    static class RateLimiter {\n        private int capacity;      // Max tokens\n        private int tokens;        // Current tokens\n        private int refillRate;    // Tokens per second\n        private long lastRefill;   // Last refill timestamp\n\n        public RateLimiter(int capacity, int refillRate) {\n            this.capacity = capacity;\n            this.tokens = capacity;\n            this.refillRate = refillRate;\n            this.lastRefill = System.currentTimeMillis();\n        }\n\n        public boolean allowRequest() {\n            // TODO: Refill tokens based on time elapsed\n            // TODO: Check if token available, consume if yes\n            return false;\n        }\n    }\n\n    public static void main(String[] args) {\n        RateLimiter limiter = new RateLimiter(5, 1);\n        for (int i = 0; i < 7; i++) {\n            System.out.println(\"Request \" + (i+1) + \": \" +\n                (limiter.allowRequest() ? \"Allowed\" : \"Blocked\"));\n        }\n    }\n}",
      "fullSolution": "import java.util.*;\n\npublic class Main {\n    static class RateLimiter {\n        private int capacity;\n        private int tokens;\n        private int refillRate;\n        private long lastRefill;\n\n        public RateLimiter(int capacity, int refillRate) {\n            this.capacity = capacity;\n            this.tokens = capacity;\n            this.refillRate = refillRate;\n            this.lastRefill = System.currentTimeMillis();\n        }\n\n        public synchronized boolean allowRequest() {\n            refillTokens();\n            if (tokens > 0) {\n                tokens--;\n                return true;\n            }\n            return false;\n        }\n\n        private void refillTokens() {\n            long now = System.currentTimeMillis();\n            long elapsed = (now - lastRefill) / 1000;\n            int tokensToAdd = (int)(elapsed * refillRate);\n            if (tokensToAdd > 0) {\n                tokens = Math.min(capacity, tokens + tokensToAdd);\n                lastRefill = now;\n            }\n        }\n    }\n\n    public static void main(String[] args) throws InterruptedException {\n        RateLimiter limiter = new RateLimiter(3, 1);\n        for (int i = 0; i < 5; i++) {\n            System.out.println(\"Request \" + (i+1) + \": \" +\n                (limiter.allowRequest() ? \"Allowed\" : \"Blocked\"));\n        }\n        Thread.sleep(2000);\n        System.out.println(\"After 2s: \" + (limiter.allowRequest() ? \"Allowed\" : \"Blocked\"));\n    }\n}",
      "expectedOutput": "Request 1: Allowed\nRequest 2: Allowed\nRequest 3: Allowed\nRequest 4: Blocked\nRequest 5: Blocked\nAfter 2s: Allowed",
      "tutorial": "<div class=\"tutorial-content\">\n<h3>System Design: Rate Limiter</h3>\n\n<h4>Introduction</h4>\n<p>Rate limiting protects APIs from abuse and ensures fair resource allocation. Used by Stripe, Twitter, and all major APIs. Token bucket is the most popular algorithm for its simplicity and efficiency.</p>\n\n<h4>Token Bucket Algorithm</h4>\n<ul>\n<li><strong>Capacity:</strong> Maximum number of tokens (burst allowance)</li>\n<li><strong>Refill Rate:</strong> Tokens added per second (sustained rate)</li>\n<li><strong>Consumption:</strong> Each request consumes 1 token</li>\n<li><strong>Refill:</strong> Tokens refilled continuously based on time elapsed</li>\n</ul>\n\n<h4>Why Token Bucket?</h4>\n<ul>\n<li>Allows bursts of traffic (up to capacity)</li>\n<li>Smooth out sustained traffic (refill rate)</li>\n<li>Memory efficient: O(1) per user</li>\n<li>Simple to implement and understand</li>\n</ul>\n\n<h4>Real-World Applications</h4>\n<p><strong>Stripe API:</strong> 100 requests/second per API key, uses token bucket with Redis.</p>\n<p><strong>Twitter API:</strong> 300 requests/15 minutes, returns X-Rate-Limit headers.</p>\n<p><strong>GitHub API:</strong> 5000 requests/hour for authenticated users.</p>\n\n<h4>Implementation in Production</h4>\n<pre><code>// Distributed rate limiting with Redis\nFUNCTION allowRequest(userId):\n    key = \"rate_limit:\" + userId\n    tokens = REDIS.GET(key)\n    if tokens == null:\n        REDIS.SET(key, capacity - 1)\n        REDIS.EXPIRE(key, 60)  // 1 minute TTL\n        return true\n    if tokens > 0:\n        REDIS.DECR(key)\n        return true\n    return false</code></pre>\n\n<h4>Best Practices</h4>\n<ul>\n<li>Return HTTP 429 (Too Many Requests) when blocked</li>\n<li>Include X-RateLimit headers (remaining, reset time)</li>\n<li>Different limits for different API tiers (free vs paid)</li>\n<li>Whitelist internal services from rate limiting</li>\n</ul>\n</div>",
      "tags": [
        "System Design",
        "Rate Limiting",
        "Token Bucket",
        "FAANG"
      ]
    },
    {
      "id": 604,
      "title": "Design Instagram/Image Service",
      "description": "Design a photo sharing service with image uploads, thumbnails, and CDN delivery",
      "language": "java",
      "initialCode": "// Design Instagram - Image Service\n// Requirements: 500M photos/day, multiple sizes, CDN delivery\n// TODO: Implement uploadImage() and getImage()\n\nimport java.util.*;\n\npublic class Main {\n    static class Image {\n        String id, originalUrl, thumbnailUrl, mediumUrl;\n        String userId;\n        long uploadTime;\n\n        Image(String id, String userId) {\n            this.id = id;\n            this.userId = userId;\n            this.uploadTime = System.currentTimeMillis();\n        }\n    }\n\n    static class ImageService {\n        private Map<String, Image> images = new HashMap<>();\n        private int counter = 1000;\n        private static final String BASE62 = \"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n\n        public String uploadImage(String userId, byte[] data) {\n            // TODO: Generate image ID\n            // TODO: Upload to storage (S3)\n            // TODO: Generate thumbnails\n            return \"\";\n        }\n\n        public Image getImage(String imageId) {\n            // TODO: Return image metadata\n            return null;\n        }\n\n        private String encodeBase62(int num) {\n            StringBuilder sb = new StringBuilder();\n            while (num > 0) {\n                sb.append(BASE62.charAt(num % 62));\n                num /= 62;\n            }\n            return sb.reverse().toString();\n        }\n    }\n\n    public static void main(String[] args) {\n        ImageService service = new ImageService();\n        String id = service.uploadImage(\"user123\", new byte[1024]);\n        System.out.println(\"Uploaded: \" + id);\n    }\n}",
      "fullSolution": "import java.util.*;\n\npublic class Main {\n    static class Image {\n        String id, originalUrl, thumbnailUrl, mediumUrl;\n        String userId;\n        long uploadTime;\n\n        Image(String id, String userId) {\n            this.id = id;\n            this.userId = userId;\n            this.uploadTime = System.currentTimeMillis();\n            this.originalUrl = \"https://cdn.example.com/images/\" + id + \"_original.jpg\";\n            this.thumbnailUrl = \"https://cdn.example.com/images/\" + id + \"_thumb.jpg\";\n            this.mediumUrl = \"https://cdn.example.com/images/\" + id + \"_medium.jpg\";\n        }\n    }\n\n    static class ImageService {\n        private Map<String, Image> images = new HashMap<>();\n        private int counter = 1000;\n        private static final String BASE62 = \"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n\n        public String uploadImage(String userId, byte[] data) {\n            String imageId = encodeBase62(counter++);\n            Image image = new Image(imageId, userId);\n\n            // Simulate upload to S3 and thumbnail generation\n            System.out.println(\"Uploading to S3: \" + image.originalUrl);\n            System.out.println(\"Generating thumbnails...\");\n\n            images.put(imageId, image);\n            return imageId;\n        }\n\n        public Image getImage(String imageId) {\n            return images.get(imageId);\n        }\n\n        private String encodeBase62(int num) {\n            StringBuilder sb = new StringBuilder();\n            while (num > 0) {\n                sb.append(BASE62.charAt(num % 62));\n                num /= 62;\n            }\n            return sb.reverse().toString();\n        }\n    }\n\n    public static void main(String[] args) {\n        ImageService service = new ImageService();\n\n        String id1 = service.uploadImage(\"user123\", new byte[1024]);\n        System.out.println(\"Photo ID: \" + id1);\n\n        Image img = service.getImage(id1);\n        System.out.println(\"Original: \" + img.originalUrl);\n        System.out.println(\"Thumbnail: \" + img.thumbnailUrl);\n        System.out.println(\"Medium: \" + img.mediumUrl);\n    }\n}",
      "expectedOutput": "Uploading to S3: https://cdn.example.com/images/G8_original.jpg\nGenerating thumbnails...\nPhoto ID: G8\nOriginal: https://cdn.example.com/images/G8_original.jpg\nThumbnail: https://cdn.example.com/images/G8_thumb.jpg\nMedium: https://cdn.example.com/images/G8_medium.jpg",
      "tutorial": "<div class=\"tutorial-content\">\n<h3>System Design: Instagram/Image Service</h3>\n\n<h4>Introduction</h4>\n<p>Design a photo sharing service that handles 500M photos/day with multiple image sizes, CDN delivery, and efficient storage. Instagram processes billions of photos using this architecture.</p>\n\n<h4>Requirements</h4>\n<ul>\n<li><strong>Functional:</strong> Upload photos, generate thumbnails, serve via CDN</li>\n<li><strong>Non-Functional:</strong> 500M photos/day, <200ms upload, <50ms retrieval</li>\n<li><strong>Scale:</strong> 500M × 365 × 5 = 912B photos over 5 years</li>\n<li><strong>Storage:</strong> 1MB avg × 912B = 912 PB (need efficient storage)</li>\n</ul>\n\n<h4>Architecture Components</h4>\n<ul>\n<li><strong>Upload Service:</strong> Receives images, generates unique ID</li>\n<li><strong>Image Processing:</strong> Resize to multiple sizes (thumbnail 150x150, medium 640x640, full 1080x1080)</li>\n<li><strong>Storage:</strong> S3/GCS for images, database for metadata</li>\n<li><strong>CDN:</strong> CloudFront/Fastly for global delivery</li>\n</ul>\n\n<h4>Image Processing Pipeline</h4>\n<pre><code>1. Client uploads image\n2. Upload service generates unique ID (Base62)\n3. Store original in S3\n4. Queue job for thumbnail generation\n5. Worker processes image (resize using ImageMagick/PIL)\n6. Upload thumbnails to S3\n7. Update metadata in database\n8. Invalidate CDN cache (if needed)</code></pre>\n\n<h4>Database Schema</h4>\n<pre><code>Table: images\n+---------------+-------------------+\n| id            | VARCHAR(10) PK    |\n| user_id       | INT               |\n| original_url  | VARCHAR(256)      |\n| thumbnail_url | VARCHAR(256)      |\n| medium_url    | VARCHAR(256)      |\n| width         | INT               |\n| height        | INT               |\n| size_bytes    | BIGINT            |\n| created_at    | TIMESTAMP         |\n+---------------+-------------------+\n\nIndex on user_id for user gallery\nIndex on created_at for recent photos</code></pre>\n\n<h4>Scaling Strategies</h4>\n<ul>\n<li><strong>Storage:</strong> Shard images by user_id hash across S3 buckets</li>\n<li><strong>Processing:</strong> Use message queue (SQS/Kafka) + worker pool</li>\n<li><strong>CDN:</strong> Serve 95% of traffic from edge locations</li>\n<li><strong>Database:</strong> Metadata in PostgreSQL with read replicas</li>\n<li><strong>Caching:</strong> Redis for popular images metadata</li>\n</ul>\n\n<h4>Real-World Implementation</h4>\n<p><strong>Instagram:</strong> Uses AWS S3 for storage, Cassandra for metadata, and Facebook's CDN. Processes over 100M photos daily.</p>\n<p><strong>Pinterest:</strong> Shards images by user_id, uses HBase for metadata, and Akamai CDN.</p>\n\n<h4>Best Practices</h4>\n<ul>\n<li>Generate thumbnails asynchronously (don't block upload)</li>\n<li>Use progressive JPEG for better loading experience</li>\n<li>Implement lazy loading (load images as user scrolls)</li>\n<li>Set Cache-Control headers (immutable images can cache forever)</li>\n<li>Monitor CDN hit ratio (aim for >90%)</li>\n</ul>\n\n<h4>Interview Discussion Points</h4>\n<ul>\n<li>Why separate metadata from images? (Cost: DB is $1/GB, S3 is $0.023/GB)</li>\n<li>How to handle image deletion? (Soft delete in DB, async cleanup in S3)</li>\n<li>How to prevent duplicate uploads? (Hash-based deduplication)</li>\n<li>How to serve appropriate size based on device? (Client specifies, or use responsive images)</li>\n</ul>\n</div>",
      "tags": [
        "System Design",
        "Images",
        "CDN",
        "Storage",
        "FAANG"
      ]
    },
    {
      "id": 616,
      "title": "Two Pointers - Array Pair Sum",
      "description": "Find two numbers in sorted array that sum to target using two pointers (O(n) time)",
      "language": "java",
      "initialCode": "// Two Pointers Pattern: Find pair that sums to target\n// Input: Sorted array, target sum\n// TODO: Implement using two pointers (left, right)\n\nimport java.util.*;\n\npublic class Main {\n    public static int[] twoSum(int[] nums, int target) {\n        // TODO: Use two pointers from both ends\n        // If sum < target, move left pointer right\n        // If sum > target, move right pointer left\n        return new int[]{-1, -1};\n    }\n\n    public static void main(String[] args) {\n        int[] nums = {2, 7, 11, 15};\n        int target = 9;\n        int[] result = twoSum(nums, target);\n        System.out.println(Arrays.toString(result));\n    }\n}",
      "fullSolution": "import java.util.*;\n\npublic class Main {\n    public static int[] twoSum(int[] nums, int target) {\n        int left = 0, right = nums.length - 1;\n\n        while (left < right) {\n            int sum = nums[left] + nums[right];\n            if (sum == target) {\n                return new int[]{left, right};\n            } else if (sum < target) {\n                left++;\n            } else {\n                right--;\n            }\n        }\n\n        return new int[]{-1, -1};\n    }\n\n    public static void main(String[] args) {\n        int[] nums1 = {2, 7, 11, 15};\n        System.out.println(\"Input: [2,7,11,15], target: 9\");\n        System.out.println(\"Output: \" + Arrays.toString(twoSum(nums1, 9)));\n\n        int[] nums2 = {1, 2, 3, 4, 6};\n        System.out.println(\"Input: [1,2,3,4,6], target: 6\");\n        System.out.println(\"Output: \" + Arrays.toString(twoSum(nums2, 6)));\n    }\n}",
      "expectedOutput": "Input: [2,7,11,15], target: 9\nOutput: [0, 1]\nInput: [1,2,3,4,6], target: 6\nOutput: [1, 3]",
      "tutorial": "<div class=\"tutorial-content\">\n<h3>Algorithm Pattern: Two Pointers</h3>\n\n<h4>Introduction</h4>\n<p>Two pointers technique reduces time complexity from O(n²) to O(n) for many array problems. Core strategy: use two pointers moving toward each other or in same direction.</p>\n\n<h4>When to Use</h4>\n<ul>\n<li>Array is sorted (or can be sorted)</li>\n<li>Finding pairs/triplets with specific sum</li>\n<li>In-place array manipulation (remove duplicates)</li>\n<li>Palindrome checking (compare from both ends)</li>\n</ul>\n\n<h4>Algorithm Explanation</h4>\n<pre><code>// Two pointers approach\nArray: [2, 7, 11, 15], target: 9\nleft = 0, right = 3\nsum = 2 + 15 = 17 > 9  → right--\nsum = 2 + 11 = 13 > 9  → right--\nsum = 2 + 7 = 9 ✓      → return [0, 1]\n\nTime: O(n), Space: O(1)</code></pre>\n\n<h4>Pattern Variations</h4>\n<ul>\n<li><strong>3Sum:</strong> Fix one element, use two pointers on rest</li>\n<li><strong>Container With Most Water:</strong> Maximize area between pointers</li>\n<li><strong>Remove Duplicates:</strong> In-place array modification</li>\n<li><strong>Palindrome:</strong> Compare characters from both ends</li>\n</ul>\n\n<h4>Real Interview Examples</h4>\n<p><strong>Google:</strong> Two Sum II, 3Sum, Container With Most Water</p>\n<p><strong>Facebook:</strong> Remove Duplicates from Sorted Array</p>\n<p><strong>Amazon:</strong> Trapping Rain Water (hard variant)</p>\n\n<h4>Time Complexity</h4>\n<ul>\n<li><strong>Two Sum (sorted):</strong> O(n) time, O(1) space</li>\n<li><strong>3Sum:</strong> O(n²) time (n × two pointers)</li>\n<li><strong>4Sum:</strong> O(n³) time</li>\n</ul>\n\n<h4>Best Practices</h4>\n<ul>\n<li>Ensure array is sorted before using two pointers</li>\n<li>Handle duplicates by skipping identical elements</li>\n<li>Watch for edge cases: empty array, single element</li>\n<li>Consider using HashMap if array cannot be sorted</li>\n</ul>\n</div>",
      "tags": [
        "Algorithms",
        "Two Pointers",
        "Arrays",
        "LeetCode",
        "FAANG"
      ]
    },
    {
      "id": 631,
      "title": "SQL Injection Prevention",
      "description": "Learn to prevent SQL injection attacks using parameterized queries and prepared statements",
      "language": "java",
      "initialCode": "// SQL Injection Prevention\n// VULNERABLE: String concatenation\n// SAFE: PreparedStatement with parameters\n\npublic class Main {\n    // UNSAFE (demonstration only - never use!)\n    public static String unsafeQuery(String username) {\n        return \"SELECT * FROM users WHERE username='\" + username + \"'\";\n        // Attack: username = \"admin' OR '1'='1\"\n    }\n\n    // TODO: Implement safe query using placeholders\n    public static String safeQuery(String username) {\n        // Use ? placeholders for parameters\n        return \"\";\n    }\n\n    public static void main(String[] args) {\n        String attack = \"admin' OR '1'='1\";\n        System.out.println(\"UNSAFE: \" + unsafeQuery(attack));\n        System.out.println(\"SAFE: \" + safeQuery(attack));\n    }\n}",
      "fullSolution": "public class Main {\n    public static String unsafeQuery(String username) {\n        return \"SELECT * FROM users WHERE username='\" + username + \"'\";\n    }\n\n    public static String safeQuery(String username) {\n        // PreparedStatement syntax (? placeholders)\n        return \"SELECT * FROM users WHERE username=?\";\n        // Database driver escapes the parameter value\n        // \"admin' OR '1'='1\" becomes literal string\n    }\n\n    public static void main(String[] args) {\n        String attack = \"admin' OR '1'='1\";\n\n        System.out.println(\"SQL Injection Prevention Demo\");\n        System.out.println(\"=\" * 40);\n        System.out.println();\n        System.out.println(\"UNSAFE Query:\");\n        System.out.println(unsafeQuery(attack));\n        System.out.println(\"Result: Bypasses authentication!\");\n        System.out.println();\n        System.out.println(\"SAFE Query:\");\n        System.out.println(safeQuery(\"admin\"));\n        System.out.println(\"Parameter: \" + attack);\n        System.out.println(\"Result: Treats input as literal string\");\n    }\n}",
      "expectedOutput": "SQL Injection Prevention Demo\n========================================\n\nUNSAFE Query:\nSELECT * FROM users WHERE username='admin' OR '1'='1'\nResult: Bypasses authentication!\n\nSAFE Query:\nSELECT * FROM users WHERE username=?\nParameter: admin' OR '1'='1\nResult: Treats input as literal string",
      "tutorial": "<div class=\"tutorial-content\">\n<h3>Security: SQL Injection Prevention</h3>\n\n<h4>Introduction</h4>\n<p>SQL Injection is #3 in OWASP Top 10. Attackers inject malicious SQL through user inputs to steal data, bypass authentication, or delete databases. Prevention requires parameterized queries.</p>\n\n<h4>Attack Example</h4>\n<pre><code>// VULNERABLE CODE\nString query = \"SELECT * FROM users WHERE username='\" + username + \"'\";\n\n// ATTACK INPUT\nusername = \"admin' OR '1'='1\"\n\n// RESULTING QUERY (bypasses authentication!)\nSELECT * FROM users WHERE username='admin' OR '1'='1'</code></pre>\n\n<h4>Safe Implementation</h4>\n<pre><code>// SAFE CODE (Java)\nString query = \"SELECT * FROM users WHERE username=?\";\nPreparedStatement pstmt = conn.prepareStatement(query);\npstmt.setString(1, username);\n\n// SAFE CODE (Python)\ncursor.execute(\"SELECT * FROM users WHERE username=?\", (username,))</code></pre>\n\n<h4>Why Parameterized Queries Work</h4>\n<ul>\n<li>Database driver separates SQL code from data</li>\n<li>Parameters are escaped automatically</li>\n<li>Single quotes in input become literal characters</li>\n<li>No way for attacker to break out of string context</li>\n</ul>\n\n<h4>Real-World Breaches</h4>\n<p><strong>Heartland Payment (2008):</strong> SQL injection stole 130M credit cards. Cost: $140M in settlements.</p>\n<p><strong>Sony Pictures (2011):</strong> SQL injection exposed 1M accounts. Class action lawsuit.</p>\n<p><strong>Bobby Tables (xkcd):</strong> \"Robert'); DROP TABLE students;--\" famous comic.</p>\n\n<h4>Prevention Techniques</h4>\n<ul>\n<li><strong>PreparedStatement (Java):</strong> ALWAYS use for dynamic queries</li>\n<li><strong>Parameterized queries:</strong> Use ? or :name placeholders</li>\n<li><strong>ORM safety:</strong> Hibernate/JPA escape automatically</li>\n<li><strong>Input validation:</strong> Whitelist allowed characters</li>\n<li><strong>Least privilege:</strong> Database user with minimal permissions</li>\n</ul>\n\n<h4>Best Practices</h4>\n<ul>\n<li>Never concatenate user input into SQL strings</li>\n<li>Use ORM frameworks (Hibernate, SQLAlchemy) when possible</li>\n<li>Whitelist validation for special cases (table names, ORDER BY)</li>\n<li>Don't expose SQL errors to users (information leakage)</li>\n<li>Run database with least privilege (read-only where possible)</li>\n</ul>\n\n<h4>Interview Tips</h4>\n<ul>\n<li>Explain difference between prepared statements and string concatenation</li>\n<li>Discuss OWASP Top 10 vulnerabilities</li>\n<li>Mention defense in depth (parameterized queries + input validation + least privilege)</li>\n<li>Know how to use PreparedStatement in Java, parameterized queries in Python</li>\n</ul>\n</div>",
      "tags": [
        "Security",
        "SQL Injection",
        "OWASP",
        "Databases",
        "FAANG"
      ]
    },
    {
      "id": 641,
      "title": "Code Review Best Practices",
      "description": "Learn to conduct effective code reviews with constructive feedback and collaboration",
      "language": "java",
      "initialCode": "// Code Review Exercise\n// Review this code and identify improvements\n\nimport java.util.*;\n\npublic class Main {\n    // Code to review:\n    public static void processData(List<String> data) {\n        for(int i=0;i<data.size();i++) {\n            String item=data.get(i);\n            if(item!=null) {\n                System.out.println(item.toUpperCase());\n            }\n        }\n    }\n\n    // TODO: List code review comments\n    // Consider: readability, performance, null safety\n\n    public static void main(String[] args) {\n        List<String> data = Arrays.asList(\"apple\", \"banana\", null, \"cherry\");\n        processData(data);\n    }\n}",
      "fullSolution": "import java.util.*;\n\npublic class Main {\n    // ORIGINAL (with issues):\n    public static void processDataOld(List<String> data) {\n        for(int i=0;i<data.size();i++) {\n            String item=data.get(i);\n            if(item!=null) {\n                System.out.println(item.toUpperCase());\n            }\n        }\n    }\n\n    // IMPROVED (after code review):\n    public static void processData(List<String> data) {\n        if (data == null || data.isEmpty()) {\n            return;\n        }\n\n        for (String item : data) {  // Enhanced for loop\n            if (item != null) {     // Proper spacing\n                System.out.println(item.toUpperCase());\n            }\n        }\n    }\n\n    public static void main(String[] args) {\n        List<String> data = Arrays.asList(\"apple\", \"banana\", null, \"cherry\");\n\n        System.out.println(\"Original:\");\n        processDataOld(data);\n\n        System.out.println(\"\\nImproved:\");\n        processData(data);\n\n        System.out.println(\"\\nReview Comments:\");\n        System.out.println(\"1. Use enhanced for loop (more readable)\");\n        System.out.println(\"2. Add spacing around operators\");\n        System.out.println(\"3. Add null check on input list\");\n    }\n}",
      "expectedOutput": "Original:\nAPPLE\nBANANA\nCHERRY\n\nImproved:\nAPPLE\nBANANA\nCHERRY\n\nReview Comments:\n1. Use enhanced for loop (more readable)\n2. Add spacing around operators\n3. Add null check on input list",
      "tutorial": "<div class=\"tutorial-content\">\n<h3>Soft Skills: Code Review Best Practices</h3>\n\n<h4>Introduction</h4>\n<p>Code reviews are essential for code quality, knowledge sharing, and catching bugs. Effective reviews balance thoroughness with speed, and provide constructive feedback that improves both code and developers.</p>\n\n<h4>What to Review</h4>\n<ul>\n<li><strong>Logic:</strong> Does the code work correctly?</li>\n<li><strong>Edge Cases:</strong> Null, empty, boundary values handled?</li>\n<li><strong>Performance:</strong> Algorithm complexity, unnecessary loops</li>\n<li><strong>Security:</strong> SQL injection, XSS, authentication</li>\n<li><strong>Readability:</strong> Clear naming, comments, structure</li>\n<li><strong>Tests:</strong> Coverage, meaningful assertions</li>\n</ul>\n\n<h4>Good Review Comments</h4>\n<pre><code>❌ BAD: \"This is wrong\"\n✅ GOOD: \"Consider enhanced for loop for readability\"\n\n❌ BAD: \"Terrible naming\"\n✅ GOOD: \"Variable 'x' could be more descriptive, like 'userId'\"\n\n✅ PRAISE: \"Nice refactoring! Much more readable.\"</code></pre>\n\n<h4>Review Etiquette</h4>\n<ul>\n<li>Review promptly (don't block teammates)</li>\n<li>Be kind (there's a person behind the code)</li>\n<li>Ask questions instead of demanding changes</li>\n<li>Praise good code (positive reinforcement)</li>\n<li>Label minor suggestions as \"nit:\" (not blocking)</li>\n</ul>\n\n<h4>Real-World Examples</h4>\n<p><strong>Google:</strong> Requires ≥1 reviewer. Average review time: 4 hours.</p>\n<p><strong>Microsoft:</strong> Code reviews reduced bugs by 60%.</p>\n<p><strong>Facebook:</strong> \"Ship, then fix\" culture, but reviews prevent critical bugs.</p>\n\n<h4>Best Practices</h4>\n<ul>\n<li>Self-review before requesting review</li>\n<li>Keep PRs small (<400 lines optimal)</li>\n<li>Use linters for style issues (automate)</li>\n<li>Provide context in PR description</li>\n<li>Both reviewer and author learn from process</li>\n</ul>\n</div>",
      "tags": [
        "Soft Skills",
        "Code Review",
        "Collaboration",
        "Best Practices"
      ]
    }
  ]
}